<app-header (helpClickEvent)="toggleHelpModal()" (settingsClickEvent)="onSettingsClick()"></app-header>

<div [style.height.px]="gameWindowHeight" class="container flex fit-content-lg">
    <div class="levels-row">
      <progress-bar [currentLevel]="currentDisplayLevel"></progress-bar>
    </div>
  <div class="row">
    <div class="clue">
      {{clue.clueNumber}}. {{clue.clue}}

    </div>
  </div>
  <div id="letters-row-wrapper" class="letter-rows-wrapper">
    <div *ngFor="let submission of submissions" class="letters-wrapper">
      <div class="letters-row" [ngClass]="{'fade-out-bck': solved}">
        <ng-container *ngFor="let letter of submission">
          <square [letterSize]="letters.length" [state]="letter.state" [letter]="letter.letter"></square>
        </ng-container>
      </div>
    </div>

    <div *ngIf="!hasLost" [ngClass]="{'shake-horizontal': invalidGuessAnimation}" class="letters-wrapper">
      <div class="letters-row" [ngClass]="{'fade-out-bck': solved, 'fade-in-fwd': !solved}">
        <ng-container *ngFor="let letter of letters; index as i; first as isFirst">
          <square [letterSize]="letters.length" (click)="setEntryIndex(i)" [highlighted]="entryIndex === i" *ngIf="isFirst" [clueNumber]="'' + clue.clueNumber" [state]="getState(i)" [letter]=getLetter(i)></square>
          <square [letterSize]="letters.length" (click)="setEntryIndex(i)" [highlighted]="entryIndex === i" *ngIf="!isFirst" [state]="getState(i)" [letter]=getLetter(i)></square>
        </ng-container>
      </div>
    </div>
  </div>



  <div class="check-row">

    <div class="checks" [ngClass]="{'pulsate-fwd': shakeChecks}">
      <ng-container *ngFor="let e of [].constructor(MAX_INCORRECT_GUESSES); index as i">
        <i class="wrong-guess fa-solid fa-lg fa-xmark" [ngClass]="{'red': i < incorrectGuesses}" ></i>
      </ng-container>
    </div>
  </div>
  <div class="toast-message" [ngClass]="{'fade-in-fwd': showToast, 'fade-out-bck': !showToast, 'hide-initial': initialHideToast}">
    <span>{{toastText}}</span>
  </div>

</div>
<div class="keyboard-container">
  <keyboard (keypressEvent)="handleVirtualKeypress($event)"
            [correctLetters]="correctLetters"
            [absentLetters]="absentLetters"
            [presentLetters]="presentLetters"
  ></keyboard>
</div>
<div *ngIf="showHelpModal" class="help-overlay">
  <app-tutorial (onClose)="toggleHelpModal()"></app-tutorial>
</div>
<div *ngIf="showResetModal">
  <app-modal headerText="Restart game" bodyText="Are you sure you want to start a new game?" [decisionModal]="true" (secondaryEvent)="toggleResetModal()" (primaryEvent)="reset()" primaryLabel="Reset" ></app-modal>
</div>
<div *ngIf="showLossModal">
  <app-modal headerText="Game over" [bodyText]="'You made it to ' + days[currentLevel] + '.'" [decisionModal]="true" primaryLabel="New game" secondaryLabel="Share" (secondaryEvent)="share()" (primaryEvent)="reset()" ></app-modal>
</div>
<div *ngIf="showWinModal">
  <app-modal headerText="You win!" [bodyText]="'You had ' + (MAX_INCORRECT_GUESSES - incorrectGuesses) + ' guesses remaining.'" [decisionModal]="true" primaryLabel="New game" secondaryLabel="Share" (secondaryEvent)="share()" (primaryEvent)="reset()" ></app-modal>
</div>